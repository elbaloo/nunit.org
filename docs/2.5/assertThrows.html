<h2>Assert.Throws Method (NUnit 2.5)</h2>

<div style="text-align: center; margin: 2em 10%; padding: 4px 0; border: 2px solid black">
  <h4>Preliminary documentation, subject to change.</h4>
</div>

<p>The Assert.Throws method is pretty much in a class by itself. Rather than
   comparing values, it attempts to invoke a code snippet, represented as
   a delegate, in order to verify that it throws a particular exception.
   
<p>Assert.Throws provides both a non-generic and (in the .NET 2.0 version)
   a generic syntax.

<div class="code"><pre>

Assert.Throws( Type expectedExceptionType, TestSnippet code );
Assert.Throws( Type expectedExceptionType, TestSnippet code, 
		string message );
Assert.Throws( Type expectedExceptionType, TestSnippet code, 
		string message, params object[] parms);

Assert.Throws&lt;T&gt;( TestSnippet code );
Assert.Throws&lt;T&gt;( TestSnippet code, string message );
Assert.Throws&lt;T&gt;( TestSnippet code, string message, 
		params object[] parms);
		
</pre></div>

<p>In the above code <b>TestSnippet</b> is a delegate of the form
<b>void TestSnippet()</b>, which is used to execute the code
in question. Under .NET 2.0, this may be an anonymous delegate.

<p>The following example shows four equivalent ways of writing the
same test. All of them except the first require .NET 2.0.

<div class="code"><pre>
[TestFixture]
public class AssertThrowsTests
{
  [Test]
  public void Tests()
  {
    Assert.Throws( typeof(ArgumentException),
      new TestSnippet(MethodThatThrows) );
	  
    Assert.Throws&lt;ArgumentException&gt;(
      new TestSnippet(MethodThatThrows) );
	  
    Assert.Throws( typeof(ArgumentException),
      delegate { throw new ArgumentException() } );
	  
    Assert.Throws&lt;ArgumentException&gt;(
      delegate { throw new ArgumentException() } );
  }
  
  void MethodThatThrows()
  {
    throw new ArgumentException();
  }

</pre></div>
